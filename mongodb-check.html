<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MongoDB ê³„ì•½ì„œ í™•ì¸</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .container {
        max-width: 1000px;
        margin: 0 auto;
      }
      .button {
        background: #007bff;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin: 5px;
      }
      .button:hover {
        background: #0056b3;
      }
      .result {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 5px;
        padding: 15px;
        margin: 10px 0;
      }
      .json {
        background: #f1f3f4;
        padding: 10px;
        border-radius: 3px;
        font-family: monospace;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸ—„ï¸ MongoDB ì €ì¥ëœ ê³„ì•½ì„œ í™•ì¸</h1>

      <button class="button" onclick="getAllContracts()">
        ëª¨ë“  ê³„ì•½ì„œ ì¡°íšŒ
      </button>
      <button class="button" onclick="getContract('6853ea9d7a781429ac733ad0')">
        íŠ¹ì • ê³„ì•½ì„œ ì¡°íšŒ
      </button>

      <div id="result" class="result" style="display: none">
        <div id="resultContent"></div>
      </div>

      <div id="explanation" class="result">
        <h3>ğŸ’¡ MongoDB ì €ì¥ ë°©ì‹ ì„¤ëª…</h3>
        <ul>
          <li><strong>ë°ì´í„°ë² ì´ìŠ¤:</strong> superlawva_docs</li>
          <li><strong>ì»¬ë ‰ì…˜:</strong> contract_data</li>
          <li><strong>í¬íŠ¸:</strong> localhost:27017</li>
          <li><strong>ì €ì¥ ìœ„ì¹˜:</strong> Docker Volume (mongodb_data)</li>
          <li>
            <strong>ê´€ë¦¬ë„êµ¬:</strong> Mongo Express (http://localhost:8081)
          </li>
        </ul>

        <h4>ğŸ”„ ì €ì¥ ê³¼ì •:</h4>
        <ol>
          <li>OCR3 API í˜¸ì¶œ â†’ íŒŒì¼ ì—…ë¡œë“œ</li>
          <li>GCP Document AI â†’ í…ìŠ¤íŠ¸ ì¶”ì¶œ</li>
          <li>Gemini API â†’ JSON êµ¬ì¡°í™”</li>
          <li>MongoDB ì €ì¥ â†’ _id ìë™ ìƒì„±</li>
          <li>í´ë¼ì´ì–¸íŠ¸ì— _id í¬í•¨ ì‘ë‹µ ë°˜í™˜</li>
        </ol>
      </div>
    </div>

    <script>
      async function getAllContracts() {
        try {
          const response = await fetch("/api/upload/ocr3/contracts/all");
          const data = await response.json();
          document.getElementById("resultContent").innerHTML =
            "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
          document.getElementById("result").style.display = "block";
        } catch (error) {
          document.getElementById("resultContent").innerHTML =
            '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + "</p>";
          document.getElementById("result").style.display = "block";
        }
      }

      async function getContract(id) {
        try {
          const response = await fetch(`/api/upload/ocr3/contracts/${id}`);
          const data = await response.json();
          document.getElementById("resultContent").innerHTML =
            "<pre>" + JSON.stringify(data, null, 2) + "</pre>";
          document.getElementById("result").style.display = "block";
        } catch (error) {
          document.getElementById("resultContent").innerHTML =
            '<p style="color: red;">ì˜¤ë¥˜: ' + error.message + "</p>";
          document.getElementById("result").style.display = "block";
        }
      }
    </script>
  </body>
</html>
